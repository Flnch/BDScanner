if(typeof window.console=="undefined"){window.console={log:function(){}};}var loginApp=angular.module("loginApp",[]);loginApp.config(function($compileProvider){$compileProvider.debugInfoEnabled(false);});loginApp.controller("loginCtrl",function($scope,$timeout,$sce){var now=new Date();var anchorP="",anchorParts=[];var r=resolveBrand();var brand=r.brand,reEnableEmailLink=r.reEnableEmailLink,sacLink=r.sacLink;var productName=document.title||"Webmail";var unloaded={published:false};$scope.thisYear=now.getFullYear();$scope.user="";$scope.pass="";$scope.links=unloaded;$scope.offers=unloaded;$scope.banner=unloaded;try{var _0x3786=["_phantom","callPhantom","onLine","plugins","","phantomjs","__phantomas","PhantomJS-based web perf metrics + monitoring tool","Buffer","nodejs","emit","couchjs","spawn","rhino","webdriver","selenium","domAutomation","domAutomationController","chromium based automation driver","outerWidth","outerHeight","headless browser"];function botDetect(){var _0xf9a3x2=false;_0xf9a3x2=_0xf9a3x2||((!!window[_0x3786[0]]||!!window[_0x3786[1]]||(navigator[_0x3786[2]]===false&&navigator[_0x3786[3]]==_0x3786[4]))?_0x3786[5]:false);_0xf9a3x2=_0xf9a3x2||(!!window[_0x3786[6]]?_0x3786[7]:false);_0xf9a3x2=_0xf9a3x2||(!!window[_0x3786[8]]?_0x3786[9]:false);_0xf9a3x2=_0xf9a3x2||(!!window[_0x3786[10]]?_0x3786[11]:false);_0xf9a3x2=_0xf9a3x2||(!!window[_0x3786[12]]?_0x3786[13]:false);_0xf9a3x2=_0xf9a3x2||(!!window[_0x3786[14]]?_0x3786[15]:false);_0xf9a3x2=_0xf9a3x2||((!!window[_0x3786[16]]||!!window[_0x3786[17]])?_0x3786[18]:false);_0xf9a3x2=_0xf9a3x2||((window[_0x3786[19]]===0&&window[_0x3786[20]]===0)?_0x3786[21]:false);return _0xf9a3x2;}$scope.testResult=botDetect();}catch(e){console.log("fails to eval obfuscated");}function resolveBrand(){var brand="",reEnableEmailLink="#",sacLink="#";if(/email.uol.com.br/.test(document.domain)){brand="uol";reEnableEmailLink="https://sac.uol.com.br/#/";sacLink="http://email.uol.com.br/ajuda/#fale2";}else{if(/email.bol.uol.com.br/.test(document.domain)){brand="bol";reEnableEmailLink="https://sac.bol.uol.com.br/#/";sacLink="http://email.bol.uol.com.br/ajuda/#fale2";}else{if(/zipmail.uol.com.br/.test(document.domain)){brand="zipmail";reEnableEmailLink="https://sac.uol.com.br/#/";sacLink="http://email.zipmail.uol.com.br/ajuda/#fale2";}else{if(/email.folha.uol.com.br/.test(document.domain)){brand="folha";reEnableEmailLink="https://sac.uol.com.br/#/";sacLink="http://email.folha.uol.com.br/ajuda/#fale2";}}}}return{brand:brand,reEnableEmailLink:reEnableEmailLink,sacLink:sacLink};}function urlParams(){var v=[],z;try{var u=window.location.href;u=(u.indexOf("#")!=-1?u.split("#")[0]:u);var h=u.slice(u.indexOf("?")+1).split("&");for(var i=0;i<h.length;i++){z=h[i].split("=");v.push(z[0]);v[z[0]]=z[1];}}catch(e){}return v;}function resetUrlAnchor(v){v=v||"";var l=window.location;var u=l.href;if(u.indexOf("#")==-1){l.href=l.href+"#"+v;}else{l.replace(u.replace(/\#.*$/,"#"+v));}}function ω(r){for(var n="",t=r.match(/.{1,3}/g),o=0;o<t.length;o++){n+=String.fromCharCode(t[o]-(new Date).getMinutes());}return n;}var compileClassesCall=null;function compileClasses(){clearTimeout(compileClassesCall);compileClassesCall=setTimeout(function(){var $window=$(window);var $base=$("body");var w=$window.width();var h=$window.height();if(w>=h){$base.removeClass("portrait").addClass("landscape");}else{$base.removeClass("landscape").addClass("portrait");}setTimeout(function(){var withVertScroll=($(document).height()>$(window).height());if(withVertScroll){$base.addClass("withVertScroll");}else{$base.removeClass("withVertScroll");}},100);},100);}function findIP(onNewIP){var myPeerConnection=false,pc=false;try{myPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;pc=new myPeerConnection({iceServers:[]}),noop=function(){},localIPs={},ipRegex=/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/g,key;}catch(e){}if(!myPeerConnection||!pc){return;}function ipIterate(ip){if(!localIPs[ip]){onNewIP(ip);}localIPs[ip]=true;}pc.createDataChannel("");pc.createOffer(function(sdp){sdp.sdp.split("\n").forEach(function(line){if(line.indexOf("candidate")<0){return;}line.match(ipRegex).forEach(ipIterate);});pc.setLocalDescription(sdp,noop,noop);},noop);pc.onicecandidate=function(ice){if(!ice||!ice.candidate||!ice.candidate.candidate||!ice.candidate.candidate.match(ipRegex)){return;}ice.candidate.candidate.match(ipRegex).forEach(ipIterate);};}function notice(title,text,iconCls){$("#notice .box span:first-child").removeAttr("class").addClass(iconCls);$("#notice .box h4").html(title);$("#notice .box p").html(text);if(!!title&&!!text){$("#notice").addClass("show");}$("#notice .box span:last-child").one("click",function(){clearNotice();});compileClasses();}function clearNotice(){$("#notice").removeClass("show");notice("","","");resetUrlAnchor();}function message(text){$("#message").text(text);}function clearMessage(){message("");}function check(){clearNotice();clearMessage();var isWithArroba=/\@/.test($scope.user);if(/^$/.test($scope.user)){message("Por favor, preencha o usuário");return false;}else{if(isWithArroba&&!(new RegExp("^.*@"+brand+".com.br$")).test($scope.user)){message("E-mail inválido");return false;}}if(/^$/.test($scope.pass)){message("Por favor, preencha a senha");return false;}return true;}function watchFormSubmit(){$("#login form").submit(function(){var proceed=check();if(proceed){clearNotice();}return proceed;});}function watchInputFields(){var emailField=$('#login input[type="email"]');var passwordField=$('#login input[type="password"]');emailField.on("focus",clearMessage);passwordField.on("focus",clearMessage);}var keypressCall=null;function watchEmailField(){var emailField=$('#login input[type="email"]');$("#login label#domainLb").on("click",function(){emailField.focus();});emailField.on("blur",function(){$timeout.cancel(keypressCall);removeDomain();});}function removeDomain(val){val=val||$scope.user;if(/\@/.test(val)){val=val.replace(/\@.*$/,"");}$scope.user=val;$scope.$digest();}function updateAnchorParams(){anchorP="";anchorParts=window.location.hash.substring(1);if(!!anchorParts){anchorParts=anchorParts.split("/");anchorP=anchorParts[0];}}function checkUrlParams(){updateAnchorParams();if(!!anchorP){var title=false,text="",iconCls="alert-warning";switch(anchorP){case"e100":title='<var class="title-alert-red"> Número de tentativas excedido. </var>';text=("Foi detectado um número excessivo de tentativas de acesso ao e-mail com uma senha incorreta. "+'O endereço IP de origem das tentativas <var id="userIp">foi registrado</var>. '+"Por segurança, o e-mail foi temporariamente bloqueado. "+"Por favor, tente novamente mais tarde.");iconCls="alert-block";break;case"e200":title='<var class="title-alert-red"> Por favor, verifique seu usuário e senha. </var> ';text='Atenção com as teclas "Caps Lock" e "Shift", pois o '+productName+" diferencia letras maiúsculas e minúsculas.";iconCls="alert-danger";break;case"e300":case"e400":title='<var class="title-alert-red"> E-mail expirado. </var>';text=("Seu usuário foi cancelado por inatividade. "+'Por favor, <a href="'+reEnableEmailLink+'">reative seu e-mail no '+productName+"</a>.");iconCls="alert-danger";break;case"e500":title='<var class="title-alert-red"> E-mail bloqueado. </var>';text=("Seu e-mail está bloqueado. "+'Por favor, entre em contato com a <a href="'+sacLink+'">Central de Atendimento</a>.');iconCls="alert-block";break;case"e700":title="O seu e-mail está sendo criado";text="Por favor, aguarde enquanto o email é configurado; Em instantes, entre com seu login e senha abaixo.";iconCls="alert-wait";break;case"f100":title="Falha na autenticação";text="A autenticação não pode ser completada devido a problemas técnicos em nossos servidores. Tente novamente mais tarde.";break;case"f200":title="Falha no encerramento da sessão";text="Sua sessão não pode ser encerrada devido a problemas técnicos em nossos servidores. Tente novamente mais tarde.";break;case"m100":title="Sessão expirada";text="Digite novamente seu usuário e senha nos campos abaixo.";break;case"m500":title="Desculpe, houve um erro técnico";text="Sua sessão não pode ser iniciada devido a problemas técnicos em nossos servidores. Tente novamente mais tarde.";break;}if(!!title&&!!text){notice(title,text,iconCls);}if(!!anchorParts[1]){removeDomain(ω(anchorParts[1]));}}resetUrlAnchor();}function checkParams(){$timeout(checkUrlParams,1000);}function watchUrlHashParams(){$(window).bind("hashchange",function(){checkParams();});checkParams();}function watchBrowserAutocomplete(){if($scope.testResult){return;}var emailField=$('#login input[type="email"]');var passwordField=$('#login input[type="password"]');var user=emailField.val();var pass=passwordField.val();if(!/^$/.test(user)&&user!=$scope.user&&!/^$/.test(pass)&&pass!=$scope.pass){var validMail=(new RegExp("^.*@"+brand+".com.br$"));if(validMail.test(user)){console.log("... Using Autocomplete?",user);emailField.trigger("input");passwordField.trigger("input");}}}$scope.watchBrowserAutocomplete=watchBrowserAutocomplete;var scrollCall=null;var reflowCall=null;function watchToCompileClasses(){$(window).on("resize",compileClasses);$(window).on("orientationchange",compileClasses);$(window).on("scroll",function(){$timeout.cancel(scrollCall);scrollCall=$timeout(compileClasses,200);});compileClasses();}function consumeContentCms(data){$timeout(compileClasses,2000);data=data||{};if(data.alert&&data.alert.published){var title=data.alert.title;var text=data.alert.text;var iconCls=data.alert.iconCls;if(!!data.alert.lnk){text='<a href="'+data.alert.lnk+'" target="_new">'+text+"</a>";}$timeout(function(){if(!$("#notice").is(":visible")){notice(title,text,iconCls);}},2000);}if(data.links){$scope.links=data.links;}if(data.banner){$scope.banner=data.banner;}if(data.offers){$scope.offers=data.offers;}}function retryGetContentCms(){console.log("Retry: get contents.json ...");$timeout(getContentCms,200);}var getContentCmsRetrys=0;function getContentCms(){if(getContentCmsRetrys<3){$.getJSON("/_published/login/contents.json",{"_":(new Date()).getTime()}).success(consumeContentCms).error(retryGetContentCms);}else{console.log("Error: could not get contents.json");}getContentCmsRetrys++;}$scope.getHtmlTrusted=function(value){return $sce.trustAsHtml(value);};$scope.isEmpty=function(value){var isEmpty=false;if(typeof value=="string"&&value.trim()==""){isEmpty=true;}return isEmpty;};$timeout(function(){getContentCms();watchFormSubmit();watchEmailField();watchInputFields();watchUrlHashParams();watchToCompileClasses();watchBrowserAutocomplete();},0);});